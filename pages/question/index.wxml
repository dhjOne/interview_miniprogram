<nav nav-type="search" />
<view class="home-container">
  <view class="home-content">
    <t-tabs value="{{currentPrimary}}" bind:change="onTabChange">
      <block wx:for="{{primaryCategories}}" wx:key="id">
        <t-tab-panel label="{{item.name}}" value="{{item.id}}">
          <t-pull-down-refresh value="{{enable}}" bind:refresh="onRefresh" loadingTexts="{{['下拉刷新', '松手刷新', '正在刷新', '刷新完成']}}">
            <!-- 每个 tab 面板内的内容 -->
            <view class="tab-content">
              
              <!-- 主体内容区域 -->
              <view class="main-content">
                <!-- 侧边二级导航 -->
                <view class="sidebar {{isSidebarCollapsed ? 'collapsed' : ''}}">
                  <view class="sidebar-header">
                    <t-icon 
                      name="{{isSidebarCollapsed ? 'chevron-right' : 'chevron-left'}}" 
                      bindtap="toggleSidebar"
                      class="collapse-icon"
                    ></t-icon>
                    <text class="sidebar-title" wx:if="{{!isSidebarCollapsed}}">分类</text>
                  </view>
                  
                  <view class="sidebar-content" wx:if="{{!isSidebarCollapsed}}">
                    <block wx:for="{{secondaryCategories}}" wx:key="id">
                      <view 
                        class="secondary-item {{currentSecondary === item.id ? 'active' : ''}}"
                        bindtap="switchSecondaryCategory"
                        data-id="{{item.id}}"
                      >
                        <t-icon name="{{item.icon}}" class="item-icon"></t-icon>
                        <text class="item-name">{{item.name}}</text>
                        <text class="item-count">{{item.count}}</text>
                      </view>
                    </block>
                  </view>
                </view>

                <!-- 内容展示区域 -->
                <view class="content-area {{isSidebarCollapsed ? 'full-width' : ''}}">
                  <!-- 图片展示区域 -->
                  <view class="images-grid">
                    <block wx:for="{{currentImages}}" wx:key="id">
                      <view class="image-card">
                        <image 
                          src="{{item.url}}" 
                          mode="aspectFill"
                          class="card-image"
                          bindtap="previewImage"
                          data-url="{{item.url}}"
                        ></image>
                        <view class="card-info">
                          <text class="image-title">{{item.title}}</text>
                          <text class="image-desc">{{item.description}}</text>
                        </view>
                      </view>
                    </block>
                  </view>
                </view>
              </view>
            </view>
          </t-pull-down-refresh>
        </t-tab-panel>
      </block>
    </t-tabs>
  </view>
</view>

<view class="home-release">
  <t-button theme="primary" size="large" icon="add" shape="round" bindtap="goRelease">
    发布
  </t-button>
</view>
<t-message id="t-message" />